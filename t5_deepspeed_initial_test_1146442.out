## Current dircectory /home/s1930443/MRP1
## Number of available CUDA devices: 0,1,2,3
## Checking status of CUDA device with nvidia-smi
Sun Mar 12 18:02:05 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 525.60.13    CUDA Version: 12.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  NVIDIA GeForce ...  Off  | 00000000:5A:00.0 Off |                  N/A |
| 30%   23C    P8    21W / 250W |    252MiB / 11264MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce ...  Off  | 00000000:62:00.0 Off |                  N/A |
| 29%   22C    P8    22W / 250W |    252MiB / 11264MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA GeForce ...  Off  | 00000000:B9:00.0 Off |                  N/A |
| 29%   20C    P8     2W / 250W |    252MiB / 11264MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA GeForce ...  Off  | 00000000:C1:00.0 Off |                  N/A |
| 29%   22C    P8     5W / 250W |    252MiB / 11264MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
[/bin/bash] #### Starting Initial T5 Training Test
[/bin/bash] ## This is s1930443 on node859 and this job has the ID 1146442
[/bin/bash] ## current working directory: /home/s1930443/MRP1
[/bin/bash] ## Run script
[2023-03-12 18:02:17,686] [WARNING] [runner.py:186:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0,1,2,3: setting --include=localhost:0,1,2,3
[2023-03-12 18:02:17,717] [INFO] [runner.py:548:main] cmd = /data1/s1930443/conda_pkgs/T5-test-env/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None t5_deepspeed_initial.py --deepspeed /home/s1930443/.config/deepspeed/ds_config_zero3.json --dataset_label artsplit --train_articles_filepath /home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv --train_comments_filepath /home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv --val_articles_filepath /home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv --val_comments_filepath /home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv --hf_model_id t5-small --train_batch_size 2 --val_batch_size 2 --train_epochs 1 --val_epochs 1 --learning_rate 0.0001 --seed 42 --max_source_len 512 --max_target_len 200 --wandb_project_name t5-deepspeed-alice-initial-test --deepspeed_config_filepath /home/s1930443/.config/deepspeed/ds_config_zero3.json
[2023-03-12 18:02:29,018] [INFO] [launch.py:142:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2023-03-12 18:02:29,019] [INFO] [launch.py:148:main] nnodes=1, num_local_procs=4, node_rank=0
[2023-03-12 18:02:29,019] [INFO] [launch.py:161:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2023-03-12 18:02:29,019] [INFO] [launch.py:162:main] dist_world_size=4
[2023-03-12 18:02:29,019] [INFO] [launch.py:164:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
Arguments passed to the script:  ['t5_deepspeed_initial.py', '--local_rank=3', '--deepspeed', '/home/s1930443/.config/deepspeed/ds_config_zero3.json', '--dataset_label', 'artsplit', '--train_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', '--train_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', '--val_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', '--val_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', '--hf_model_id', 't5-small', '--train_batch_size', '2', '--val_batch_size', '2', '--train_epochs', '1', '--val_epochs', '1', '--learning_rate', '0.0001', '--seed', '42', '--max_source_len', '512', '--max_target_len', '200', '--wandb_project_name', 't5-deepspeed-alice-initial-test', '--deepspeed_config_filepath', '/home/s1930443/.config/deepspeed/ds_config_zero3.json']
Running script with the following arguments:  {'deepspeed': '/home/s1930443/.config/deepspeed/ds_config_zero3.json', 'dataset_label': 'artsplit', 'train_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', 'train_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', 'val_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', 'val_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', 'hf_model_id': 't5-small', 'train_batch_size': '2', 'val_batch_size': '2', 'train_epochs': '1', 'val_epochs': '1', 'learning_rate': '0.0001', 'seed': '42', 'max_source_len': '512', 'max_target_len': '200', 'wandb_project_name': 't5-deepspeed-alice-initial-test', 'deepspeed_config_filepath': '/home/s1930443/.config/deepspeed/ds_config_zero3.json'}
Arguments passed to the script:  ['t5_deepspeed_initial.py', '--local_rank=0', '--deepspeed', '/home/s1930443/.config/deepspeed/ds_config_zero3.json', '--dataset_label', 'artsplit', '--train_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', '--train_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', '--val_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', '--val_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', '--hf_model_id', 't5-small', '--train_batch_size', '2', '--val_batch_size', '2', '--train_epochs', '1', '--val_epochs', '1', '--learning_rate', '0.0001', '--seed', '42', '--max_source_len', '512', '--max_target_len', '200', '--wandb_project_name', 't5-deepspeed-alice-initial-test', '--deepspeed_config_filepath', '/home/s1930443/.config/deepspeed/ds_config_zero3.json']
Running script with the following arguments:  {'deepspeed': '/home/s1930443/.config/deepspeed/ds_config_zero3.json', 'dataset_label': 'artsplit', 'train_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', 'train_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', 'val_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', 'val_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', 'hf_model_id': 't5-small', 'train_batch_size': '2', 'val_batch_size': '2', 'train_epochs': '1', 'val_epochs': '1', 'learning_rate': '0.0001', 'seed': '42', 'max_source_len': '512', 'max_target_len': '200', 'wandb_project_name': 't5-deepspeed-alice-initial-test', 'deepspeed_config_filepath': '/home/s1930443/.config/deepspeed/ds_config_zero3.json'}
Arguments passed to the script:  ['t5_deepspeed_initial.py', '--local_rank=1', '--deepspeed', '/home/s1930443/.config/deepspeed/ds_config_zero3.json', '--dataset_label', 'artsplit', '--train_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', '--train_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', '--val_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', '--val_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', '--hf_model_id', 't5-small', '--train_batch_size', '2', '--val_batch_size', '2', '--train_epochs', '1', '--val_epochs', '1', '--learning_rate', '0.0001', '--seed', '42', '--max_source_len', '512', '--max_target_len', '200', '--wandb_project_name', 't5-deepspeed-alice-initial-test', '--deepspeed_config_filepath', '/home/s1930443/.config/deepspeed/ds_config_zero3.json']
Running script with the following arguments:  {'deepspeed': '/home/s1930443/.config/deepspeed/ds_config_zero3.json', 'dataset_label': 'artsplit', 'train_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', 'train_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', 'val_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', 'val_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', 'hf_model_id': 't5-small', 'train_batch_size': '2', 'val_batch_size': '2', 'train_epochs': '1', 'val_epochs': '1', 'learning_rate': '0.0001', 'seed': '42', 'max_source_len': '512', 'max_target_len': '200', 'wandb_project_name': 't5-deepspeed-alice-initial-test', 'deepspeed_config_filepath': '/home/s1930443/.config/deepspeed/ds_config_zero3.json'}
Arguments passed to the script:  ['t5_deepspeed_initial.py', '--local_rank=2', '--deepspeed', '/home/s1930443/.config/deepspeed/ds_config_zero3.json', '--dataset_label', 'artsplit', '--train_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', '--train_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', '--val_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', '--val_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', '--hf_model_id', 't5-small', '--train_batch_size', '2', '--val_batch_size', '2', '--train_epochs', '1', '--val_epochs', '1', '--learning_rate', '0.0001', '--seed', '42', '--max_source_len', '512', '--max_target_len', '200', '--wandb_project_name', 't5-deepspeed-alice-initial-test', '--deepspeed_config_filepath', '/home/s1930443/.config/deepspeed/ds_config_zero3.json']
Running script with the following arguments:  {'deepspeed': '/home/s1930443/.config/deepspeed/ds_config_zero3.json', 'dataset_label': 'artsplit', 'train_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', 'train_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', 'val_articles_filepath': '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', 'val_comments_filepath': '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', 'hf_model_id': 't5-small', 'train_batch_size': '2', 'val_batch_size': '2', 'train_epochs': '1', 'val_epochs': '1', 'learning_rate': '0.0001', 'seed': '42', 'max_source_len': '512', 'max_target_len': '200', 'wandb_project_name': 't5-deepspeed-alice-initial-test', 'deepspeed_config_filepath': '/home/s1930443/.config/deepspeed/ds_config_zero3.json'}
11993 11993
11993 11993
11993 11993
11993 11993
100 100
100 100
100 100
100 100
[2023-03-12 18:06:31,984] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2023-03-12 18:06:41,067] [INFO] [partition_parameters.py:415:__exit__] finished initializing model with 0.08B parameters
Initiating Fine-Tuning for the model on the dataset
Initiating Fine-Tuning for the model on the dataset
Initiating Fine-Tuning for the model on the dataset
Initiating Fine-Tuning for the model on the dataset
[2023-03-12 18:06:52,360] [INFO] [launch.py:318:sigkill_handler] Killing subprocess 30773
[2023-03-12 18:06:52,361] [INFO] [launch.py:318:sigkill_handler] Killing subprocess 30774
[2023-03-12 18:06:53,223] [INFO] [launch.py:318:sigkill_handler] Killing subprocess 30781
[2023-03-12 18:06:53,800] [INFO] [launch.py:318:sigkill_handler] Killing subprocess 30797
[2023-03-12 18:06:54,133] [ERROR] [launch.py:324:sigkill_handler] ['/data1/s1930443/conda_pkgs/T5-test-env/bin/python', '-u', 't5_deepspeed_initial.py', '--local_rank=3', '--deepspeed', '/home/s1930443/.config/deepspeed/ds_config_zero3.json', '--dataset_label', 'artsplit', '--train_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_train_artsplit.csv', '--train_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_train_artsplit.csv', '--val_articles_filepath', '/home/s1930443/MRP1/data/artsplit/r_art_val_artsplit.csv', '--val_comments_filepath', '/home/s1930443/MRP1/data/artsplit/r_cmt_val_artsplit.csv', '--hf_model_id', 't5-small', '--train_batch_size', '2', '--val_batch_size', '2', '--train_epochs', '1', '--val_epochs', '1', '--learning_rate', '0.0001', '--seed', '42', '--max_source_len', '512', '--max_target_len', '200', '--wandb_project_name', 't5-deepspeed-alice-initial-test', '--deepspeed_config_filepath', '/home/s1930443/.config/deepspeed/ds_config_zero3.json'] exits with return code = 1
[/bin/bash] ## Script finished
[/bin/bash] ## Deactivating environment and close job.
